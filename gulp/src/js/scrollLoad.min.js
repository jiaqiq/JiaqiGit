!function(e){"function"==typeof define?define.cmd?define("ecar/ECar.scrollLoad",["$","zepto/touch","ecar/ECar.utils"],function(o,n,t){"define:nomunge,require:nomunge,exports:nomunge,module:nomunge";var r=o("$");o("zepto/touch");var a=o("ecar/ECar.utils");return e(r,a,{})}):define(["$","zepto/touch","ecar/ECar.utils"],function(o,n,t){"define:nomunge,require:nomunge,exports:nomunge,module:nomunge";return e(o,t,{})}):e($,window.ECar||(window.ECar={}))}(function(e,o,n){function t(e){this.cfg=e,this.init()}return n.scrollLoad?n.scrollLoad:(n.scrollLoad=function(o){var n={loadNode:".scrollLoding",url:null,totalPage:1,curPage:1,bottom:80,successCallback:function(e){},beforeSendCallback:function(){}};config=e.extend({},n,o||{}),new t(config)},t.prototype={init:function(){function n(){if(a){var o=r.beforeSendCallback();if(!o&&void 0!=o)return!1;a=!1;var n=r.url.replace("{#PAGENUM}",r.curPage);e.ajax({type:"GET",url:n,dataType:"html",success:function(e){r.successCallback(e),r.curPage>=parseInt(r.totalPage)?(c.hide(),a=!1):(r.curPage=r.curPage+1,a=!0)},error:function(){a=!0,c.html("网络不给力,请点击重新加载")}})}}var t=this,r=t.cfg,a=!0,c=e(r.loadNode);r.totalPage<=1?(c.hide(),a=!1):r.curPage=2,window.addEventListener("scroll",function(){var o=e(document).height(),t=navigator.userAgent.toLowerCase();t.indexOf("iphone")!=-1||t.indexOf("ios")!=-1?o=o-60-r.bottom:o-=r.bottom;var a=Math.max(document.documentElement.scrollTop||document.body.scrollTop);a+e(window).height()>=o&&(r.curPage>parseInt(r.totalPage)?c.hide():n())},100);var u=o.clickEvent();c.on(u,function(){n()})}},n.scrollLoad)});